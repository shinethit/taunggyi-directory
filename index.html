<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cherry Directory by Shine Thit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pyidaungsu:wght@400;700&display=swap');
        body { 
            font-family: 'Pyidaungsu', sans-serif; 
            padding-bottom: 110px; /* Nav bar အတွက် နေရာပိုပေးထားသည် */
            background-color: #f8f5ff;
        }
        .page { display: none; opacity: 0; transition: opacity 0.2s ease-in-out; }
        .active-page { display: block; opacity: 1; }
        
        /* Theme Colors */
        .gold-gradient { background: linear-gradient(135deg, #D4AF37 0%, #FFD700 50%, #B8860B 100%); }
        .purple-gradient { background: linear-gradient(135deg, #37006a 0%, #5e0a9e 100%); }
    </style>
</head>
<body>

    <header class="purple-gradient text-white pt-8 pb-8 px-4 shadow-2xl text-center rounded-b-[40px] border-b-4 border-[#D4AF37] relative z-0 overflow-hidden">
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>

        <div class="relative z-10">
            <div class="flex justify-center mb-5">
                <img src="CDST_Logo.png" alt="CDST Logo" 
                     class="w-36 h-36 rounded-2xl border-4 border-[#FFD700] shadow-2xl object-cover bg-[#37006a]">
            </div>
            
            <h1 id="pageTitle" class="text-3xl font-bold tracking-wider text-[#FFD700] drop-shadow-md font-['Pyidaungsu']">Home</h1>
            <p class="text-sm text-gray-200 mt-2 tracking-widest uppercase font-semibold">Cherry Directory since 2026</p>
        </div>
    </header>

    <div class="max-w-4xl mx-auto p-4 mt-2 mb-20">
        
        <section id="homePage" class="page active-page space-y-4">
            <div class="flex items-center mb-2 px-2">
                <i class="fa fa-bullhorn text-[#4B0082] mr-2 text-xl"></i>
                <h2 class="font-bold text-lg text-[#4B0082]">သတင်းနှင့် ပွဲတော်ရက်များ</h2>
            </div>
            <div id="announcementList" class="space-y-4 pb-4">
                <div class="text-center text-gray-400 py-10 animate-pulse">Loading updates...</div>
            </div>
        </section>

        <section id="directoryPage" class="page">
            <div class="sticky top-2 z-30 bg-[#f8f5ff]/95 backdrop-blur-sm py-2">
                <div class="relative">
                    <input type="text" id="searchInput" onkeyup="filterDirectory()" 
                           placeholder="လုပ်ငန်းအမည် ရှာရန်..." 
                           class="w-full p-3 pl-10 rounded-xl shadow-md border border-[#D4AF37] outline-none focus:ring-2 focus:ring-[#4B0082]">
                    <i class="fa fa-search absolute left-4 top-4 text-[#D4AF37]"></i>
                </div>
            </div>
            <div id="directoryList" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                </div>
        </section>

        <section id="contactPage" class="page">
            <div class="bg-white p-6 rounded-3xl shadow-lg border-t-4 border-[#4B0082]">
                <div class="text-center mb-6">
                    <div class="w-20 h-20 gold-gradient rounded-full mx-auto flex items-center justify-center text-white text-3xl mb-3 shadow-md">
                        <i class="fa fa-user-tie"></i>
                    </div>
                    <h2 class="font-bold text-2xl text-[#4B0082]">Shine Thit</h2>
                    <p class="text-gray-500 text-sm">Creator & Manager</p>
                </div>
                <div id="contactInfo" class="space-y-3 bg-gray-50 p-4 rounded-xl">
                    </div>
            </div>
        </section>

    </div>

    <nav class="fixed bottom-4 left-4 right-4 bg-[#37006a] text-gray-400 flex justify-around items-center p-2 shadow-2xl z-[9999] rounded-2xl border border-[#D4AF37]/50">
        
        <button onclick="showPage('home', 'Home')" class="nav-item flex flex-col items-center p-2 w-16 transition-all duration-300 text-[#FFD700]" id="nav-home">
            <i class="fa fa-home text-xl mb-1"></i>
            <span class="text-[10px] font-bold">Home</span>
        </button>

        <button onclick="showPage('directory', 'Directory')" class="nav-item flex flex-col items-center p-2 w-16 transition-all duration-300 relative" id="nav-directory">
             <div class="bg-[#D4AF37] text-[#37006a] w-12 h-12 rounded-full flex items-center justify-center -mt-8 shadow-[0_4px_10px_rgba(212,175,55,0.5)] border-4 border-[#f8f5ff] transform transition-transform duration-300 hover:scale-110">
                <i class="fa fa-search text-xl font-bold"></i>
            </div>
            <span class="text-[10px] font-bold mt-1">Search</span>
        </button>

        <button onclick="showPage('contact', 'Contact')" class="nav-item flex flex-col items-center p-2 w-16 transition-all duration-300 hover:text-gray-200" id="nav-contact">
            <i class="fa fa-info-circle text-xl mb-1"></i>
            <span class="text-[10px] font-bold">Contact</span>
        </button>
    </nav>

    <script>
        // ==========================================
        // သင့် ID များ (အရင်အတိုင်း ပြန်ထည့်ပါ)
        // ==========================================
        const SHEET_ID = 'သင့်_GOOGLE_SHEET_ID_ဒီမှာထည့်ပါ';
        const GID_HOME = '0'; 
        const GID_DIR = 'သင့်_DIRECTORY_TAB_GID'; 
        const GID_CONTACT = 'သင့်_CONTACT_TAB_GID';
        // ==========================================

        const BASE_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;
        let dirData = [];

        async function loadAllData() {
            // Load Announcements
            fetchData(`${BASE_URL}&gid=${GID_HOME}`, (rows) => {
                const list = document.getElementById('announcementList');
                if(!rows || rows.length === 0) { list.innerHTML = '<p class="text-center text-gray-400">No updates yet</p>'; return; }
                
                list.innerHTML = rows.map(r => `
                    <div class="bg-white rounded-xl shadow-sm overflow-hidden border-l-4 border-[#D4AF37] flex mb-3">
                        ${r.c[3]?.v ? `<img src="${r.c[3].v}" class="w-24 h-24 object-cover">` : ''}
                        <div class="p-3 flex-1">
                            <h3 class="font-bold text-[#4B0082] line-clamp-1">${r.c[0]?.v || ''}</h3>
                            <p class="text-xs text-gray-500 line-clamp-2 mt-1">${r.c[1]?.v || ''}</p>
                            <div class="text-[#D4AF37] text-xs font-bold mt-2"><i class="fa fa-calendar-alt mr-1"></i> ${r.c[2]?.v || ''}</div>
                        </div>
                    </div>
                `).join('');
            });

            // Load Directory
            fetchData(`${BASE_URL}&gid=${GID_DIR}`, (rows) => {
                dirData = rows.map(r => ({
                    name: r.c[0]?.v, cat: r.c[1]?.v, type: r.c[2]?.v, 
                    addr: r.c[3]?.v, ward: r.c[4]?.v, 
                    phones: [r.c[6]?.v, r.c[7]?.v, r.c[8]?.v].filter(Boolean), 
                    img: r.c[10]?.v
                }));
                renderDirectory(dirData);
            });

            // Load Contact
            fetchData(`${BASE_URL}&gid=${GID_CONTACT}`, (rows) => {
                document.getElementById('contactInfo').innerHTML = rows.map(r => `
                    <div class="flex justify-between py-2 border-b border-gray-100 last:border-0">
                        <span class="text-[#4B0082] font-bold text-sm">${r.c[0]?.v}:</span>
                        <span class="text-gray-600 text-sm text-right">${r.c[1]?.v}</span>
                    </div>
                `).join('');
            });
        }

        async function fetchData(url, callback) {
            try {
                const res = await fetch(url);
                const text = await res.text();
                const json = JSON.parse(text.substr(47).slice(0, -2));
                callback(json.table.rows);
            } catch (e) { console.log('Loading...'); }
        }

        function renderDirectory(data) {
            document.getElementById('directoryList').innerHTML = data.map(i => `
                <div class="bg-white rounded-2xl p-4 shadow-md border-b-2 border-[#D4AF37]">
                    <div class="flex items-start gap-3">
                        ${i.img ? `<img src="${i.img}" class="w-16 h-16 rounded-lg object-cover bg-gray-100">` : `<div class="w-16 h-16 rounded-lg bg-[#f8f5ff] flex items-center justify-center text-[#D4AF37]"><i class="fa fa-store text-2xl"></i></div>`}
                        <div class="flex-1">
                            <span class="bg-[#f8f5ff] text-[#4B0082] text-[10px] font-bold px-2 py-1 rounded mb-1 inline-block">${i.cat || 'General'}</span>
                            <h3 class="font-bold text-[#4B0082] text-md">${i.name}</h3>
                            <p class="text-xs text-gray-500 mt-1"><i class="fa fa-map-pin mr-1 text-[#D4AF37]"></i>${i.ward || i.addr}</p>
                        </div>
                    </div>
                    <div class="mt-3 flex gap-2">
                        ${i.phones.map(p => `<a href="tel:${p}" class="flex-1 bg-[#4B0082] text-white text-center py-2 rounded-lg text-xs font-bold shadow hover:bg-[#5e0a9e]"><i class="fa fa-phone mr-1"></i> Call</a>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        // ====== FIXED NAVIGATION LOGIC ======
        function showPage(pageId, title) {
            // 1. Hide all pages
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('active-page');
                setTimeout(() => p.style.display = 'none', 200);
            });

            // 2. Show active page
            const activePage = document.getElementById(pageId + 'Page');
            activePage.style.display = 'block';
            setTimeout(() => activePage.classList.add('active-page'), 10);
            
            document.getElementById('pageTitle').innerText = title;
            
            // 3. Update Nav Buttons
            // Reset all
            document.querySelectorAll('.nav-item').forEach(btn => {
                if(btn.id !== 'nav-directory') {
                    btn.classList.remove('text-[#FFD700]', 'scale-110');
                    btn.classList.add('text-gray-400');
                } else {
                    btn.querySelector('div').classList.remove('ring-4', 'ring-[#FFD700]/30');
                }
            });

            // Highlight active button
            const activeBtn = document.getElementById('nav-' + pageId);
            if (pageId === 'directory') {
                activeBtn.querySelector('div').classList.add('ring-4', 'ring-[#FFD700]/30');
            } else {
                activeBtn.classList.remove('text-gray-400');
                activeBtn.classList.add('text-[#FFD700]', 'scale-110');
            }

            window.scrollTo(0, 0);
        }

        loadAllData();
    </script>
</body>
</html>
